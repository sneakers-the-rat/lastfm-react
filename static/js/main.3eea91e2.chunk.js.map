{"version":3,"sources":["scrape/scraper.js","components/TopBar.js","components/Heatmap.js","components/Waterfall.js","App.js","reportWebVitals.js","index.js"],"names":["API_KEY","process","console","log","axios","require","retryInterceptor","lfm","create","baseURL","method","lfmRetry","getPage","username","page","cb","a","get","params","api_key","format","limit","user","ret","res","data","pages","totalPages","promises","i","push","Promise","all","maxAttempts","waitTime","errorCodes","onRetry","error","warn","config","__retryCount","TopBar","props","state","currentPage","downloading","progress","userData","scrapeData","bind","updateProgress","updateUsername","this","setState","getAllPages","then","r","clean_data","all_tracks","forEach","tracks","track","date","Date","uts","artist","album","name","cleanData","sendData","event","target","value","Grid","container","spacing","justify","alignItems","height","item","xs","TextField","id","label","type","size","variant","color","fullWidth","onChange","CircularProgress","style","margin","display","Button","onClick","length","disabled","width","React","Component","d3","Heatmap","d","day","getFullYear","getMonth","getDate","nest","key","rollup","entries","values","reduce","accumulator","currentval","sort","b","years","groups","getUTCFullYear","reverse","cellSize","timeWeek","utcSunday","countDay","formatMonth","utcFormat","color_max","quantile","map","Math","abs","ascending","scaleLinear","domain","interpolate","interpolateHcl","range","rgb","svg","select","attr","year","append","selectAll","join","text","count","utcYear","getUTCDay","undefined","tooltip_html","other_projects_sum","month","utcMonths","utcMonth","filter","t","max","min","w","n","ceil","node","className","Waterfall","window","d3Collection","theme","createMuiTheme","palette","primary","pink","secondary","purple","ViewButtons","selected","ButtonGroup","setSelected","App","receiveData","new_data","new_state","view","padding","ThemeProvider","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3eea91e2.chunk.js","sourcesContent":["// lifted from https://lastfm.ghan.nl/export/\n\nconst API_KEY = process.env.REACT_APP_LASTFM_API_KEY;\nconsole.log(API_KEY)\n\nconst axios = require('axios');\nconst retryInterceptor = require('axios-retry-interceptor');\nconst FileSaver = require('file-saver');\n\n\nconst lfm = axios.create({\n        baseURL: 'https://ws.audioscrobbler.com/2.0',\n        method: 'get',\n      }),\n      lfmRetry = axios.create({\n        baseURL: 'https://ws.audioscrobbler.com/2.0',\n        method: 'get',\n      });\n\nconst typeData = {\n  scrobbles: {\n    key: 'scrobbles',\n    label: 'Scrobbles',\n    method: 'user.getRecentTracks',\n    rootItem: 'recenttracks'\n  },\n  loves: {\n    key: 'loves',\n    label: 'Loved tracks',\n    method: 'user.getLovedTracks',\n    rootItem: 'lovedtracks'\n  }\n};\n\nretryInterceptor(lfmRetry, {\n  maxAttempts: 5,\n  waitTime: 5000,\n  errorCodes: [404, 500, 501, 502, 503, 504],\n  onRetry: function(error){\n    console.warn(\"Performing retry \" + error.config.__retryCount);\n  }\n});\n\nasync function getPage(username, page, cb, lfm){\n  // console.log(\"get page\" + page)\n  const ret = await lfm.get('/', {\n    params: {\n      api_key: API_KEY,\n      format: 'json',\n      method: 'user.getRecentTracks',\n      limit: 200,\n      user: username,\n      page: page\n    }\n  });\n\n  const res = ret.data['recenttracks'],\n        pages = res['@attr'].totalPages;\n\n  if (cb) cb(page, pages);\n  return res;\n}\n\nexport async function getAllPages(username, cb){\n  console.log(cb)\n  // debugger\n  try{\n    const res = await getPage(username, 1, cb, lfm),\n          pages = res['@attr'].totalPages,\n          promises = [res];\n\n    for (var i=2;i<=pages;i++){\n      promises.push(getPage(username, i, cb, lfmRetry));\n    }\n\n    return Promise.all(promises);\n\n  } catch(e) {\n    console.log(e);\n  }\n\n}\n\n\nexport function cleanData(data){\n  // var lines = [[\"uts\", \"utc_time\", \"artist\", \"album\", \"track\",].join(\",\") + \"\\r\\n\"];\n  \n  var all_tracks = [];\n  data.forEach(function(tracks){\n    tracks.track.forEach(function(track){\n      if (track.date){\n        all_tracks.push({\n          'date': new Date(track.date.uts*1000),\n          'artist': track.artist['#text'],\n          'album': track.album['#text'],\n          'track': track.name\n        })\n      }\n    });\n  });\n  return(all_tracks);\n}\n\n\nfunction saveData(data, form, fn) {\n\n  if (form.format == \"CSV\"){\n    var lines = [[\"uts\", \"utc_time\", \"artist\", \"artist_mbid\", \"album\", \"album_mbid\", \"track\", \"track_mbid\"].join(\",\") + \"\\r\\n\"];\n    data.forEach(function(tracks){\n      tracks.track.forEach(function(track){\n        if (track.date){\n          lines.push([\n            csv(track.date.uts),\n            csv(track.date['#text']),\n            csv(form.type==\"scrobbles\"?track.artist['#text']:track.artist.name),\n            csv(track.artist.mbid),\n            csv(form.type==\"scrobbles\"?track.album['#text']:\"\"),\n            csv(form.type==\"scrobbles\"?track.album.mbid:\"\"),\n            csv(track.name),\n            csv(track.mbid)\n          ].join(\",\") + \"\\r\\n\");\n        }\n      });\n    });\n    const csvblob = new Blob(lines, {type: \"text/csv\"});\n    return FileSaver.saveAs(csvblob, fn + \".csv\");\n  }\n\n\n  if (form.format == \"JSON\") {\n    const blob = new Blob([JSON.stringify(data)], {type: \"application/json\"});\n    return FileSaver.saveAs(blob, fn + \".json\");\n  }\n\n}\n\nfunction csv(val){\n  if (val)\n    return \"\\\"\" + (val).toString().replace(/\"/g, \"\\\"\\\"\") + \"\\\"\";\n  else\n    return \"\\\"\\\"\";\n}","import React from \"react\";\n\n\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\n\nimport { getAllPages, cleanData } from '../scrape/scraper.js'\n\n\nclass TopBar extends React.Component {\n\n\tstate = {\n        username: '',\n        currentPage: 0,\n        totalPages: 0,\n        downloading: false,\n        progress: 0,\n        userData: ''\n    }\n\n    constructor(props){\n    \tsuper(props);\n    \tthis.scrapeData = this.scrapeData.bind(this);\n    \tthis.updateProgress = this.updateProgress.bind(this);\n    \tthis.updateUsername = this.updateUsername.bind(this);\n\n    }\n\n\n\n\n\n    scrapeData(){\n    \tconsole.log('scraping')\n    \tconsole.log(this.state.username);\n\n    \tthis.setState({downloading: true})\n    \tgetAllPages(this.state.username, this.updateProgress, process.env.REACT_APP_LASTFM_API_KEY).then(r => {\n    \t\tif (!r){\n    \t\t\tconsole.log('no data gotten!!');\n    \t\t\treturn;\n    \t\t}\n\n    \t\t// clean data\n    \t\tlet clean_data = cleanData(r);\n    \t\tthis.setState({userData: clean_data});\n\n\n    \t\tthis.props.sendData(clean_data)\n    \t})\n\n\n    }\n\n    updateProgress(page, pages){\n    \t// console.log('updateprogress: page' + page + \"total pages\" + pages)\n\n    \tthis.setState({currentPage: this.state.currentPage + 1,\n    \t\t\t\t   totalPages: pages})\n\n    \t// console.log(\"curentPage: \" + this.state.currentPage + \"totalPages: \" + this.state.totalPages + \" progress: \" )\n\n    \tthis.setState({progress: (this.state.currentPage / this.state.totalPages) * 100})\n    }\n\n    updateUsername(event){\n    \tthis.setState({username:event.target.value});\n    \t// console.log('username:' + this.state.username);\n    }\n\n    render(){\n    \treturn(\n            <Grid container spacing={1} justify=\"flex-end\" alignItems=\"center\" height=\"100%\">\n            <Grid item xs={8}>\n                <TextField \n                    id=\"username\" \n                    label=\"Last.fm Username\" \n                    type=\"search\" \n                    size=\"small\" \n                    variant=\"outlined\" \n                    color=\"primary\"\n                    fullWidth \n                    onChange={this.updateUsername}/>\n            </Grid>\n            <Grid item xs={1}>\n                <CircularProgress variant=\"determinate\" value={this.state.progress} style={{margin:'auto', display:'block'}}/>\n                \n            </Grid>\n            <Grid item xs={3}>\n                <Button \n                onClick={this.scrapeData}\n                variant=\"contained\" \n                color=\"primary\"\n                size=\"large\"\n                {...this.state.username.length ? {disabled:false} : {disabled:true}}\n                style={{width: \"100%\", height:\"100%\"}}>Scrape Data</Button>\n            </Grid>\n            </Grid>\n\n        \n        )\n    }\n\n}\n\nexport default TopBar;","//\n// using code from\n// https://observablehq.com/@d3/calendar-view\n// and\n// https://github.com/g1eb/calendar-heatmap\n// <3\n//\n\nimport React from \"react\";\n\nimport { nest } from 'd3-collection';\n// import {legend} from \"@d3/color-legend\";\nconst d3 = require('d3');\n\n// let data = 0;\n\nclass Heatmap extends React.Component {\n\n  constructor(props){\n    super(props);\n    // this.renderCalendar = this.renderCalendar.bind(this)\n  }\n\n  componentDidMount(){\n\n    let data = this.props.data;\n    console.log('initial data');\n    console.log(data);\n    data.forEach(function(d){\n      d.day = new Date(\n              d.date.getFullYear(), \n              d.date.getMonth(), \n              d.date.getDate());\n    })\n\n    // double nest to get each artist play per day\n    data = nest()\n            .key(function(d){return(d.day)})\n            .key(function(d){return(d.artist)})\n            .rollup(function(d){return(d.length)})\n            .entries(data);\n\n    // summarize total plays for each day\n    data.forEach(function(d){\n      d.date = new Date(d.key);\n      // console.log(d);\n      d.value = d.values.reduce(function(accumulator, currentval){return(accumulator + currentval.value)}, 0);\n      //   sort values!\n      d.values = d.values.sort(function(a,b){return(b.value-a.value)});\n      // let sortable = Object.entries(d.values)\n      //     .sort(([,a],[,b]) => a-b)\n      //     .reduce((r, [k, v]) => ({ ...r, [k]: v }), {});\n      // d.summary = sortable;\n    })\n\n    console.log('final data');\n    console.log(data);\n\n    // console.log(data);\n\n    // debugger;\n    let years = d3.groups(data, d => d.date.getUTCFullYear()).reverse();\n    let cellSize = 17;\n    let width = 954;\n    let height = 153;\n    let weekday = \"sunday\";\n    let timeWeek = weekday === \"sunday\" ? d3.utcSunday : d3.utcMonday;\n    let countDay = weekday === \"sunday\" ? i => i : i => (i + 6) % 7;\n\n\n    let formatValue = d3.format(\"\")\n    let formatClose = d3.format(\"$,.2f\")\n    let formatDate = d3.utcFormat(\"%x\")\n    let formatDay = i => \"SMTWTFS\"[i]\n    let formatMonth = d3.utcFormat(\"%b\")\n\n    let color_max = d3.quantile(data.map(d => Math.abs(d.value)).sort(d3.ascending), 0.9975);\n    let color =  d3.scaleLinear().domain([0,color_max])\n        .interpolate(d3.interpolateHcl)\n        .range([d3.rgb(\"#111111\"), d3.rgb('#e91e63')]);\n        // d3.scaleSequential(d3.interpolateRdPu).domain([0, +color_max]);\n\n\n\n    function pathMonth(t) {\n      const n = weekday === \"weekday\" ? 5 : 7;\n      const d = Math.max(0, Math.min(n, countDay(t.getUTCDay())));\n      const w = timeWeek.count(d3.utcYear(t), t);\n      return `${d === 0 ? `M${w * cellSize},0`\n          : d === n ? `M${(w + 1) * cellSize},0`\n          : `M${(w + 1) * cellSize},0V${d * cellSize}H${w * cellSize}`}V${n * cellSize}`;\n    }\n\n\n    const svg = d3.select('#calendar-svg')\n      .attr(\"viewBox\", [0, 0, width, height * years.length])\n      .attr(\"font-family\", \"sans-serif\")\n      .attr(\"font-size\", 10);\n\n    const tooltip = d3.select(\"#calendar-svg\").append('div')\n        .attr('class', 'heatmap-tooltip')\n        .style('opacity', 0);\n\n    const year = svg.selectAll(\"g\")\n    .data(years)\n    .join(\"g\")\n      .attr(\"transform\", (d, i) => `translate(40.5,${height * i + cellSize * 1.5})`);\n\n    year.append(\"text\")\n      .attr(\"x\", -5)\n      .attr(\"y\", -5)\n      .attr(\"font-weight\", \"bold\")\n      .attr(\"text-anchor\", \"end\")\n      .text(([key]) => key);\n\n    year.append(\"g\")\n      .attr(\"text-anchor\", \"end\")\n    .selectAll(\"text\")\n    .data(weekday === \"weekday\" ? d3.range(1, 6) : d3.range(7))\n    .join(\"text\")\n      .attr(\"x\", -5)\n      .attr(\"y\", i => (countDay(i) + 0.5) * cellSize)\n      .attr(\"dy\", \"0.31em\")\n      .text(formatDay);\n\n    year.append(\"g\")\n    .selectAll(\"rect\")\n    .data(weekday === \"weekday\"\n        ? ([, values]) => values.filter(d => ![0, 6].includes(d.date.getUTCDay()))\n        : ([, values]) => values)\n    .join(\"rect\")\n      .attr(\"width\", cellSize - 1)\n      .attr(\"height\", cellSize - 1)\n      .attr(\"x\", d => timeWeek.count(d3.utcYear(d.date), d.date) * cellSize + 0.5)\n      .attr(\"y\", d => countDay(d.date.getUTCDay()) * cellSize + 0.5)\n      .attr(\"fill\", d => color(d.value))\n      .append(\"title\")\n      .text(function(d){\n        // debugger;\n        // console.log(d);\n        if (d.values === undefined){\n          return('');\n        }\n        var tooltip_html = '';\n        tooltip_html += 'Total songs listened:' + d.value +\"\\n\";\n\n        if (d.values.length <= 5) {\n          for (var i = 0; i < d.values.length; i++) {\n            tooltip_html += d.values[i].key + ': ';\n            tooltip_html += d.values[i].value + '\\n';\n          };\n        } else {\n          for (var i = 0; i < 5; i++) {\n            tooltip_html += d.values[i].key + \": \";\n            tooltip_html += d.values[i].value + '\\n';\n          };\n          tooltip_html += '\\n';\n\n          var other_projects_sum = 0;\n          for (var i = 5; i < d.values.length; i++) {\n            other_projects_sum = +d.values[i].value;\n          };\n          tooltip_html += 'Other: ';\n          tooltip_html += other_projects_sum;\n        }\n        return(tooltip_html);\n\n    // tooltip.html(tooltip_html)\n    //     .style('left', (timeWeek.count(d3.utcYear(d.date), d.date) * cellSize + 0.5)+\"px\")\n    //     .style('top', (countDay(d.date.getUTCDay()) * cellSize + 0.5)+\"px\")\n    //     .transition()\n    //     .duration(100)\n    //     .ease(d3.easeLinear)\n    //     .style('opacity', 1);\n    //   return(tooltip_html)\n      });\n\n    // debugger;\n    const month = year.append(\"g\")\n    .selectAll(\"g\")\n    .data(([, values]) => d3.utcMonths(values[values.length - 1].date, d3.utcMonth(values[0].date)))\n    .join(\"g\");\n    // console.log(month);\n\n    month.filter((d, i) => i).append(\"path\")\n      .attr(\"fill\", \"none\")\n      .attr('class', 'month-path')\n      .attr(\"d\", pathMonth);\n\n\n    month.append(\"text\")\n      .attr(\"x\", d => timeWeek.count(d3.utcYear(d), timeWeek.ceil(d)) * cellSize + 2)\n      .attr(\"y\", -5)\n      .text(formatMonth);\n\n    console.log(month);\n\n    return svg.node();\n\n    }\n\n  render(){\n    return(\n    <div className=\"calendar-map\">\n      <svg id=\"calendar-svg\"></svg>\n    </div>\n    )\n  }\n\n\n}\n\n\nfunction nest_data(data){\n\treturn(\n\t    nest()\n\t    \t.key(function(d){return new Date(\n\t    \t\td.date.getFullYear(), \n\t    \t\td.date.getMonth(), \n\t    \t\td.date.getDay());\n\t    })\n\t    \t.rollup(function(d){return(d.length)})\n\t    \t.entries(data)\n\t)\n}\n\nexport default Heatmap;","import React from \"react\";\n\n\nclass Waterfall extends React.Component{\n\n    constructor(props){\n        super(props)\n    }\n\n    componentDidMount(){\n        let data = this.props.data;\n\n        \n    }\n\n    render(){\n        return(<div>hay</div>)\n    }\n}\n\nexport default Waterfall","import React from \"react\";\n\nimport './styles/index.scss';\nimport TopBar from './components/TopBar.js';\nimport Heatmap from './components/Heatmap.js';\nimport Waterfall from \"./components/Waterfall\";\nimport * as d3Collection from 'd3-collection';\n\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\n\n\nimport { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\nimport purple from '@material-ui/core/colors/purple';\nimport pink from '@material-ui/core/colors/pink';\nconst d3 = require('d3');\n\nwindow.d3 = d3;\nwindow.d3Collection = d3Collection;\n\n\n\nconst theme = createMuiTheme({\n  palette: {\n    type: 'dark',\n    primary: pink,\n    secondary: purple,\n  },\n});\n\nclass ViewButtons extends React.Component {\n\n  render(){\n      let disabled = false;\n      if (this.props.selected === \"init\"){\n        disabled = true;\n      }\n\n      return(\n          <ButtonGroup className=\"plot-selection\" disabled={disabled} color=\"primary\">\n            <Button onClick={() => {this.props.setSelected('timeline')}}>Heatmap</Button>\n            <Button onClick={() => {this.props.setSelected('waterfall')}}>Waterfall</Button>\n          </ButtonGroup>\n      )\n\n  }\n}\n\nclass App extends React.Component {\n\n  state = {\n    data: '',\n    selected: 'init'\n  }\n\n  constructor(props){\n    super(props);\n    this.receiveData = this.receiveData.bind(this);\n    this.setSelected = this.setSelected.bind(this);\n  }\n\n  receiveData(new_data){\n    this.setState({data: new_data,\n                   selected:'timeline'});\n    // console.log('parent got data')\n    // console.log(new_data)\n    // debugger;\n    // create_chart(new_data)\n\n  }\n\n  setSelected(new_state){\n    this.setState({selected:new_state})\n  }\n\n\n\n  render(){\n    let view;\n    let buttons;\n\n    let disabled = false;\n    if (this.state.selected == \"init\"){\n      view = <h1 style={{padding: '1rem'}}>Scrape some data to continue!</h1>;\n      disabled = true;\n    } else if (this.state.selected == \"timeline\") {\n      view = <Heatmap data={this.state.data} />;\n    } else if (this.state.selected == \"waterfall\"){\n      view = <Waterfall data={this.state.data} />;\n    }\n\n    return(\n    <ThemeProvider theme={theme}>\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <TopBar sendData={this.receiveData}/>\n      </header>\n      <ViewButtons selected={this.state.selected} setSelected={this.setSelected}/>\n      {view}\n    </div>\n    </ThemeProvider>\n    ); \n  }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}