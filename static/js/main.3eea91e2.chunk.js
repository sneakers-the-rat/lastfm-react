(this["webpackJsonplastfm-react"]=this["webpackJsonplastfm-react"]||[]).push([[0],{105:function(t,e,a){"use strict";a.r(e);var n=a(7),r=a(0),c=a.n(r),s=a(11),i=a.n(s),o=(a(72),a(20)),l=a(14),u=a(12),d=a(19),h=a(18),p=(a(73),a(44)),f=a(107),b=a(141),v=a(148),g=a(145),j=a(8),m=a.n(j),O=a(45),y="f199709f1e5dafbb608c8e37d2afb359";console.log(y);var x=a(75),k=a(93),w=(a(98),x.create({baseURL:"https://ws.audioscrobbler.com/2.0",method:"get"})),D=x.create({baseURL:"https://ws.audioscrobbler.com/2.0",method:"get"});function S(t,e,a,n){return C.apply(this,arguments)}function C(){return(C=Object(O.a)(m.a.mark((function t(e,a,n,r){var c,s,i;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get("/",{params:{api_key:y,format:"json",method:"user.getRecentTracks",limit:200,user:e,page:a}});case 2:return c=t.sent,s=c.data.recenttracks,i=s["@attr"].totalPages,n&&n(a,i),t.abrupt("return",s);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function P(){return(P=Object(O.a)(m.a.mark((function t(e,a){var n,r,c,s;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),t.prev=1,t.next=4,S(e,1,a,w);case 4:for(n=t.sent,r=n["@attr"].totalPages,c=[n],s=2;s<=r;s++)c.push(S(e,s,a,D));return t.abrupt("return",Promise.all(c));case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))).apply(this,arguments)}k(D,{maxAttempts:5,waitTime:5e3,errorCodes:[404,500,501,502,503,504],onRetry:function(t){console.warn("Performing retry "+t.config.__retryCount)}});var M=function(t){Object(d.a)(a,t);var e=Object(h.a)(a);function a(t){var n;return Object(l.a)(this,a),(n=e.call(this,t)).state={username:"",currentPage:0,totalPages:0,downloading:!1,progress:0,userData:""},n.scrapeData=n.scrapeData.bind(Object(o.a)(n)),n.updateProgress=n.updateProgress.bind(Object(o.a)(n)),n.updateUsername=n.updateUsername.bind(Object(o.a)(n)),n}return Object(u.a)(a,[{key:"scrapeData",value:function(){var t=this;console.log("scraping"),console.log(this.state.username),this.setState({downloading:!0}),function(t,e){return P.apply(this,arguments)}(this.state.username,this.updateProgress,"f199709f1e5dafbb608c8e37d2afb359").then((function(e){if(e){var a=function(t){var e=[];return t.forEach((function(t){t.track.forEach((function(t){t.date&&e.push({date:new Date(1e3*t.date.uts),artist:t.artist["#text"],album:t.album["#text"],track:t.name})}))})),e}(e);t.setState({userData:a}),t.props.sendData(a)}else console.log("no data gotten!!")}))}},{key:"updateProgress",value:function(t,e){this.setState({currentPage:this.state.currentPage+1,totalPages:e}),this.setState({progress:this.state.currentPage/this.state.totalPages*100})}},{key:"updateUsername",value:function(t){this.setState({username:t.target.value})}},{key:"render",value:function(){return Object(n.jsxs)(b.a,{container:!0,spacing:1,justify:"flex-end",alignItems:"center",height:"100%",children:[Object(n.jsx)(b.a,{item:!0,xs:8,children:Object(n.jsx)(v.a,{id:"username",label:"Last.fm Username",type:"search",size:"small",variant:"outlined",color:"primary",fullWidth:!0,onChange:this.updateUsername})}),Object(n.jsx)(b.a,{item:!0,xs:1,children:Object(n.jsx)(g.a,{variant:"determinate",value:this.state.progress,style:{margin:"auto",display:"block"}})}),Object(n.jsx)(b.a,{item:!0,xs:3,children:Object(n.jsx)(f.a,Object(p.a)(Object(p.a)({onClick:this.scrapeData,variant:"contained",color:"primary",size:"large"},this.state.username.length?{disabled:!1}:{disabled:!0}),{},{style:{width:"100%",height:"100%"},children:"Scrape Data"}))})]})}}]),a}(c.a.Component),T=a(10),U=a(35),F=a(58);var A=function(t){Object(d.a)(a,t);var e=Object(h.a)(a);function a(t){return Object(l.a)(this,a),e.call(this,t)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var t=this.props.data;console.log("initial data"),console.log(t),t.forEach((function(t){t.day=new Date(t.date.getFullYear(),t.date.getMonth(),t.date.getDate())})),(t=Object(U.nest)().key((function(t){return t.day})).key((function(t){return t.artist})).rollup((function(t){return t.length})).entries(t)).forEach((function(t){t.date=new Date(t.key),t.value=t.values.reduce((function(t,e){return t+e.value}),0),t.values=t.values.sort((function(t,e){return e.value-t.value}))})),console.log("final data"),console.log(t);var e=F.groups(t,(function(t){return t.date.getUTCFullYear()})).reverse(),a=17,n=F.utcSunday,r=function(t){return t},c=(F.format(""),F.format("$,.2f"),F.utcFormat("%x"),F.utcFormat("%b")),s=F.quantile(t.map((function(t){return Math.abs(t.value)})).sort(F.ascending),.9975),i=F.scaleLinear().domain([0,s]).interpolate(F.interpolateHcl).range([F.rgb("#111111"),F.rgb("#e91e63")]);var o=F.select("#calendar-svg").attr("viewBox",[0,0,954,153*e.length]).attr("font-family","sans-serif").attr("font-size",10),l=(F.select("#calendar-svg").append("div").attr("class","heatmap-tooltip").style("opacity",0),o.selectAll("g").data(e).join("g").attr("transform",(function(t,e){return"translate(40.5,".concat(153*e+25.5,")")})));l.append("text").attr("x",-5).attr("y",-5).attr("font-weight","bold").attr("text-anchor","end").text((function(t){return Object(T.a)(t,1)[0]})),l.append("g").attr("text-anchor","end").selectAll("text").data(F.range(7)).join("text").attr("x",-5).attr("y",(function(t){return(r(t)+.5)*a})).attr("dy","0.31em").text((function(t){return"SMTWTFS"[t]})),l.append("g").selectAll("rect").data((function(t){return Object(T.a)(t,2)[1]})).join("rect").attr("width",16).attr("height",16).attr("x",(function(t){return n.count(F.utcYear(t.date),t.date)*a+.5})).attr("y",(function(t){return r(t.date.getUTCDay())*a+.5})).attr("fill",(function(t){return i(t.value)})).append("title").text((function(t){if(void 0===t.values)return"";var e="";if(e+="Total songs listened:"+t.value+"\n",t.values.length<=5)for(var a=0;a<t.values.length;a++)e+=t.values[a].key+": ",e+=t.values[a].value+"\n";else{for(a=0;a<5;a++)e+=t.values[a].key+": ",e+=t.values[a].value+"\n";e+="\n";var n=0;for(a=5;a<t.values.length;a++)n=+t.values[a].value;e+="Other: ",e+=n}return e}));var u=l.append("g").selectAll("g").data((function(t){var e=Object(T.a)(t,2)[1];return F.utcMonths(e[e.length-1].date,F.utcMonth(e[0].date))})).join("g");return u.filter((function(t,e){return e})).append("path").attr("fill","none").attr("class","month-path").attr("d",(function(t){var e=Math.max(0,Math.min(7,r(t.getUTCDay()))),c=n.count(F.utcYear(t),t);return"".concat(0===e?"M".concat(c*a,",0"):7===e?"M".concat((c+1)*a,",0"):"M".concat((c+1)*a,",0V").concat(e*a,"H").concat(c*a),"V").concat(119)})),u.append("text").attr("x",(function(t){return n.count(F.utcYear(t),n.ceil(t))*a+2})).attr("y",-5).text(c),console.log(u),o.node()}},{key:"render",value:function(){return Object(n.jsx)("div",{className:"calendar-map",children:Object(n.jsx)("svg",{id:"calendar-svg"})})}}]),a}(c.a.Component),L=function(t){Object(d.a)(a,t);var e=Object(h.a)(a);function a(t){return Object(l.a)(this,a),e.call(this,t)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.props.data}},{key:"render",value:function(){return Object(n.jsx)("div",{children:"hay"})}}]),a}(c.a.Component),E=a(146),Y=a(62),N=a(147),R=a(61),z=a.n(R),B=a(60),H=a.n(B),I=a(58);window.d3=I,window.d3Collection=U;var W=Object(Y.a)({palette:{type:"dark",primary:H.a,secondary:z.a}}),_=function(t){Object(d.a)(a,t);var e=Object(h.a)(a);function a(){return Object(l.a)(this,a),e.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var t=this,e=!1;return"init"===this.props.selected&&(e=!0),Object(n.jsxs)(E.a,{className:"plot-selection",disabled:e,color:"primary",children:[Object(n.jsx)(f.a,{onClick:function(){t.props.setSelected("timeline")},children:"Heatmap"}),Object(n.jsx)(f.a,{onClick:function(){t.props.setSelected("waterfall")},children:"Waterfall"})]})}}]),a}(c.a.Component),J=function(t){Object(d.a)(a,t);var e=Object(h.a)(a);function a(t){var n;return Object(l.a)(this,a),(n=e.call(this,t)).state={data:"",selected:"init"},n.receiveData=n.receiveData.bind(Object(o.a)(n)),n.setSelected=n.setSelected.bind(Object(o.a)(n)),n}return Object(u.a)(a,[{key:"receiveData",value:function(t){this.setState({data:t,selected:"timeline"})}},{key:"setSelected",value:function(t){this.setState({selected:t})}},{key:"render",value:function(){var t;return"init"==this.state.selected?(t=Object(n.jsx)("h1",{style:{padding:"1rem"},children:"Scrape some data to continue!"}),!0):"timeline"==this.state.selected?t=Object(n.jsx)(A,{data:this.state.data}):"waterfall"==this.state.selected&&(t=Object(n.jsx)(L,{data:this.state.data})),Object(n.jsx)(N.a,{theme:W,children:Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("header",{className:"App-header",children:Object(n.jsx)(M,{sendData:this.receiveData})}),Object(n.jsx)(_,{selected:this.state.selected,setSelected:this.setSelected}),t]})})}}]),a}(c.a.Component),V=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,149)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,c=e.getLCP,s=e.getTTFB;a(t),n(t),r(t),c(t),s(t)}))};i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(J,{})}),document.getElementById("root")),V()},72:function(t,e,a){},73:function(t,e,a){}},[[105,1,2]]]);
//# sourceMappingURL=main.3eea91e2.chunk.js.map