(this["webpackJsonplastfm-react"]=this["webpackJsonplastfm-react"]||[]).push([[0],{104:function(t,e,a){"use strict";a.r(e);var n=a(12),r=a(0),c=a.n(r),s=a(9),o=a.n(s),i=(a(71),a(14)),u=a(13),l=a(21),d=a(29),p=a(27),g=(a(72),a(44)),h=a(146),f=a(139),b=a(145),m=a(143),j=a(6),v=a.n(j),x=a(45),y="f199709f1e5dafbb608c8e37d2afb359";console.log(y);var O=a(74),w=a(92),k=(a(97),O.create({baseURL:"https://ws.audioscrobbler.com/2.0",method:"get"})),D=O.create({baseURL:"https://ws.audioscrobbler.com/2.0",method:"get"});function P(t,e,a,n){return C.apply(this,arguments)}function C(){return(C=Object(x.a)(v.a.mark((function t(e,a,n,r){var c,s,o;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("get page"+a),t.next=3,r.get("/",{params:{api_key:y,format:"json",method:"user.getRecentTracks",limit:200,user:e,page:a}});case 3:return c=t.sent,s=c.data.recenttracks,o=s["@attr"].totalPages,n&&n(a,o),t.abrupt("return",s);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(){return(S=Object(x.a)(v.a.mark((function t(e,a){var n,r,c,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),t.prev=1,t.next=4,P(e,1,a,k);case 4:for(n=t.sent,r=n["@attr"].totalPages,c=[n],s=2;s<=r;s++)c.push(P(e,s,a,D));return t.abrupt("return",Promise.all(c));case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))).apply(this,arguments)}w(D,{maxAttempts:5,waitTime:5e3,errorCodes:[404,500,501,502,503,504],onRetry:function(t){console.warn("Performing retry "+t.config.__retryCount)}});var M=function(t){Object(d.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state={username:"",currentPage:0,totalPages:0,downloading:!1,progress:0,userData:""},n.scrapeData=n.scrapeData.bind(Object(l.a)(n)),n.updateProgress=n.updateProgress.bind(Object(l.a)(n)),n.updateUsername=n.updateUsername.bind(Object(l.a)(n)),n}return Object(u.a)(a,[{key:"scrapeData",value:function(){var t=this;console.log("scraping"),console.log(this.state.username),this.setState({downloading:!0}),function(t,e){return S.apply(this,arguments)}(this.state.username,this.updateProgress,"f199709f1e5dafbb608c8e37d2afb359").then((function(e){if(e){var a=function(t){var e=[];return t.forEach((function(t){t.track.forEach((function(t){t.date&&e.push({date:new Date(1e3*t.date.uts),artist:t.artist["#text"],album:t.album["#text"],track:t.name})}))})),e}(e);t.setState({userData:a}),t.props.sendData(a)}else console.log("no data gotten!!")}))}},{key:"updateProgress",value:function(t,e){console.log("updateprogress: page"+t+"total pages"+e),this.setState({currentPage:this.state.currentPage+1,totalPages:e}),console.log("curentPage: "+this.state.currentPage+"totalPages: "+this.state.totalPages+" progress: "),this.setState({progress:this.state.currentPage/this.state.totalPages*100})}},{key:"updateUsername",value:function(t){this.setState({username:t.target.value}),console.log("username:"+this.state.username)}},{key:"render",value:function(){return Object(n.jsxs)(f.a,{container:!0,spacing:1,justify:"flex-end",alignItems:"center",height:"100%",children:[Object(n.jsx)(f.a,{item:!0,xs:8,children:Object(n.jsx)(b.a,{id:"username",label:"Last.fm Username",type:"search",size:"small",variant:"outlined",color:"primary",fullWidth:!0,onChange:this.updateUsername})}),Object(n.jsx)(f.a,{item:!0,xs:1,children:Object(n.jsx)(m.a,{variant:"determinate",value:this.state.progress,style:{margin:"auto",display:"block"}})}),Object(n.jsx)(f.a,{item:!0,xs:3,children:Object(n.jsx)(h.a,Object(g.a)(Object(g.a)({onClick:this.scrapeData,variant:"contained",color:"primary",size:"large"},this.state.username.length?{disabled:!1}:{disabled:!0}),{},{style:{width:"100%",height:"100%"},children:"Scrape Data"}))})]})}}]),a}(c.a.Component),U=a(8),F=a(35),T=a(57);var A=function(t){Object(d.a)(a,t);var e=Object(p.a)(a);function a(t){return Object(i.a)(this,a),e.call(this,t)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var t=this.props.data;t.forEach((function(t){t.day=new Date(t.date.getFullYear(),t.date.getMonth(),t.date.getDate())})),(t=Object(F.nest)().key((function(t){return t.day})).rollup((function(t){return t.length})).entries(t)).forEach((function(t){t.date=new Date(t.key)})),console.log(t);var e=T.groups(t,(function(t){return t.date.getUTCFullYear()})).reverse(),a=17,n=T.utcSunday,r=function(t){return t},c=T.format(""),s=(T.format("$,.2f"),T.utcFormat("%x")),o=T.utcFormat("%b"),i=T.quantile(t.map((function(t){return Math.abs(t.value)})).sort(T.ascending),.9975),u=T.scaleLinear().domain([0,i]).interpolate(T.interpolateHcl).range([T.rgb("#111111"),T.rgb("#e91e63")]);var l=T.select("#calendar-svg").attr("viewBox",[0,0,954,153*e.length]).attr("font-family","sans-serif").attr("font-size",10),d=l.selectAll("g").data(e).join("g").attr("transform",(function(t,e){return"translate(40.5,".concat(153*e+25.5,")")}));d.append("text").attr("x",-5).attr("y",-5).attr("font-weight","bold").attr("text-anchor","end").text((function(t){return Object(U.a)(t,1)[0]})),d.append("g").attr("text-anchor","end").selectAll("text").data(T.range(7)).join("text").attr("x",-5).attr("y",(function(t){return(r(t)+.5)*a})).attr("dy","0.31em").text((function(t){return"SMTWTFS"[t]})),d.append("g").selectAll("rect").data((function(t){return Object(U.a)(t,2)[1]})).join("rect").attr("width",16).attr("height",16).attr("x",(function(t){return n.count(T.utcYear(t.date),t.date)*a+.5})).attr("y",(function(t){return r(t.date.getUTCDay())*a+.5})).attr("fill",(function(t){return u(t.value)})).append("title").text((function(t){return"".concat(s(t.date),"\n    ").concat(c(t.value)," songs played")}));var p=d.append("g").selectAll("g").data((function(t){var e=Object(U.a)(t,2)[1];return T.utcMonths(e[e.length-1].date,T.utcMonth(e[0].date))})).join("g");return p.filter((function(t,e){return e})).append("path").attr("fill","none").attr("class","month-path").attr("d",(function(t){var e=Math.max(0,Math.min(7,r(t.getUTCDay()))),c=n.count(T.utcYear(t),t);return"".concat(0===e?"M".concat(c*a,",0"):7===e?"M".concat((c+1)*a,",0"):"M".concat((c+1)*a,",0V").concat(e*a,"H").concat(c*a),"V").concat(119)})),p.append("text").attr("x",(function(t){return n.count(T.utcYear(t),n.ceil(t))*a+2})).attr("y",-5).text(o),console.log(p),l.node()}},{key:"render",value:function(){return Object(n.jsx)("div",{className:"calendar-map",children:Object(n.jsx)("svg",{id:"calendar-svg"})})}}]),a}(c.a.Component),L=a(61),E=a(144),Y=a(60),R=a.n(Y),z=a(59),B=a.n(z),I=a(57);window.d3=I,window.d3Collection=F;var N=Object(L.a)({palette:{type:"dark",primary:B.a,secondary:R.a}}),_=function(t){Object(d.a)(a,t);var e=Object(p.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state={data:"",selected:"init"},n.receiveData=n.receiveData.bind(Object(l.a)(n)),n}return Object(u.a)(a,[{key:"receiveData",value:function(t){this.setState({data:t,selected:"timeline"}),console.log("parent got data"),console.log(t)}},{key:"render",value:function(){var t;return"init"==this.state.selected?t=Object(n.jsx)("h1",{style:{padding:"1rem"},children:"Scrape some data to continue!"}):"timeline"==this.state.selected&&(t=Object(n.jsx)(A,{data:this.state.data})),Object(n.jsx)(E.a,{theme:N,children:Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("header",{className:"App-header",children:Object(n.jsx)(M,{sendData:this.receiveData})}),t]})})}}]),a}(c.a.Component),H=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,147)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,c=e.getLCP,s=e.getTTFB;a(t),n(t),r(t),c(t),s(t)}))};o.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(_,{})}),document.getElementById("root")),H()},71:function(t,e,a){},72:function(t,e,a){}},[[104,1,2]]]);
//# sourceMappingURL=main.f6119f79.chunk.js.map